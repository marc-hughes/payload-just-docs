<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/payload-just-docs/_next/static/css/adeeaed65336a824.css" as="style" crossorigin=""/><link rel="stylesheet" href="/payload-just-docs/_next/static/css/adeeaed65336a824.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/payload-just-docs/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/payload-just-docs/_next/static/chunks/webpack-c335844537ee4527.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/framework-fae63b21a27d6472.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/main-4b5290d5009800e1.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/pages/_app-2747846ed27f1501.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/pages/docs/%5B...slug%5D-e023289636109d90.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/pbayt_BRhSN28J-gcoKlf/_buildManifest.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/pbayt_BRhSN28J-gcoKlf/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><div class="container mx-auto px-4 py-8 max-w-4xl"><h1 class="text-4xl font-bold mb-4">Respecting Access Control with Local API Operations</h1><p class="text-xl text-gray-600 mb-8">Learn how to implement and enforce access control in Payload&#x27;s Local API operations, ensuring that the right permissions are respected during data manipulation.</p><div class="prose prose-lg max-w-none"><p>In Payload, local API operations <strong>override access control by default</strong>. This means that operations will run without checking if the current user has permission to perform the action. This is useful in certain scenarios where access control is not necessary, but it is important to be aware of when to enforce it for security reasons.</p>
<h3>Default Behavior: Access Control Skipped</h3>
<p>By default, <strong>local API operations skip access control</strong>. This allows operations to execute without the system checking if the current user has appropriate permissions. This might be helpful in admin or server-side scripts where the user context is not required to perform the operation.</p>
<h4>For example:</h4>
<pre><code class="language-ts">// Access control is this operation would be skipped by default
const test = await payload.create({
  collection: &#x27;users&#x27;,
  data: {
    email: &#x27;test@test.com&#x27;,
    password: &#x27;test&#x27;,
  },
})
</code></pre>
<h3>Respecting Access Control</h3>
<p>If you want to respect access control and ensure that the operation is performed only if the user has appropriate permissions, you need to explicitly pass the <code>user</code> object and set the <code>overrideAccess</code> option to <code>false</code>.</p>
<ul>
<li><code>overrideAccess: false</code>: This ensures that access control is <strong>not skipped</strong> and the operation respects the current user&#x27;s permissions.</li>
<li><code>user</code>: Pass the authenticated user context to the operation. This ensures the system checks whether the user has the right permissions to perform the action.</li>
</ul>
<pre><code class="language-ts">const authedCreate = await payload.create({
  collection: &#x27;users&#x27;,
  overrideAccess: false, // This ensures access control will be applied
  user, // Pass the authenticated user to check permissions
  data: {
    email: &#x27;test@test.com&#x27;,
    password: &#x27;test&#x27;,
  },
})
</code></pre>
<p>This example will only allow the document to be created if the <code>user</code> we passed has the appropriate access control permissions.</p></div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"frontMatter":{"title":"Respecting Access Control with Local API Operations","label":"Access Control","order":40,"desc":"Learn how to implement and enforce access control in Payload's Local API operations, ensuring that the right permissions are respected during data manipulation.","keywords":"server functions, local API, Payload, CMS, access control, permissions, user context, server-side logic, custom workflows, data management, headless CMS, TypeScript, Node.js, backend"},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    strong: \"strong\",\n    h3: \"h3\",\n    h4: \"h4\",\n    pre: \"pre\",\n    code: \"code\",\n    ul: \"ul\",\n    li: \"li\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"In Payload, local API operations \", _jsx(_components.strong, {\n        children: \"override access control by default\"\n      }), \". This means that operations will run without checking if the current user has permission to perform the action. This is useful in certain scenarios where access control is not necessary, but it is important to be aware of when to enforce it for security reasons.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Default Behavior: Access Control Skipped\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"By default, \", _jsx(_components.strong, {\n        children: \"local API operations skip access control\"\n      }), \". This allows operations to execute without the system checking if the current user has appropriate permissions. This might be helpful in admin or server-side scripts where the user context is not required to perform the operation.\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      children: \"For example:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"// Access control is this operation would be skipped by default\\nconst test = await payload.create({\\n  collection: 'users',\\n  data: {\\n    email: 'test@test.com',\\n    password: 'test',\\n  },\\n})\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Respecting Access Control\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you want to respect access control and ensure that the operation is performed only if the user has appropriate permissions, you need to explicitly pass the \", _jsx(_components.code, {\n        children: \"user\"\n      }), \" object and set the \", _jsx(_components.code, {\n        children: \"overrideAccess\"\n      }), \" option to \", _jsx(_components.code, {\n        children: \"false\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"overrideAccess: false\"\n        }), \": This ensures that access control is \", _jsx(_components.strong, {\n          children: \"not skipped\"\n        }), \" and the operation respects the current user's permissions.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"user\"\n        }), \": Pass the authenticated user context to the operation. This ensures the system checks whether the user has the right permissions to perform the action.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const authedCreate = await payload.create({\\n  collection: 'users',\\n  overrideAccess: false, // This ensures access control will be applied\\n  user, // Pass the authenticated user to check permissions\\n  data: {\\n    email: 'test@test.com',\\n    password: 'test',\\n  },\\n})\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This example will only allow the document to be created if the \", _jsx(_components.code, {\n        children: \"user\"\n      }), \" we passed has the appropriate access control permissions.\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/docs/[...slug]","query":{"slug":["local-api","access-control"]},"buildId":"pbayt_BRhSN28J-gcoKlf","assetPrefix":"/payload-just-docs","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>