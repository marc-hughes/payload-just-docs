<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Operations - Authentication Operations | Payload CMS Documentation</title><meta name="description" content="Enabling Authentication automatically makes key operations available such as Login, Logout, Verify, Unlock, Reset Password and more."/><meta property="og:title" content="Operations - Authentication Operations | Payload CMS Documentation"/><meta property="og:description" content="Enabling Authentication automatically makes key operations available such as Login, Logout, Verify, Unlock, Reset Password and more."/><meta name="next-head-count" content="6"/><link rel="preload" href="/payload-just-docs/_next/static/css/adeeaed65336a824.css" as="style" crossorigin=""/><link rel="stylesheet" href="/payload-just-docs/_next/static/css/adeeaed65336a824.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/payload-just-docs/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/payload-just-docs/_next/static/chunks/webpack-c335844537ee4527.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/framework-fae63b21a27d6472.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/main-4b5290d5009800e1.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/pages/_app-2747846ed27f1501.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/pages/docs/%5B...slug%5D-8726031e66a50318.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/_tTBTu5tMI_qrBgEpmt0H/_buildManifest.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/_tTBTu5tMI_qrBgEpmt0H/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><div class="container mx-auto px-4 py-8 max-w-4xl"><h1 class="text-4xl font-bold mb-4">Authentication Operations</h1><p class="text-xl text-gray-600 mb-8">Enabling Authentication automatically makes key operations available such as Login, Logout, Verify, Unlock, Reset Password and more.</p><div class="prose prose-lg max-w-none"><p>Enabling <a href="./overview">Authentication</a> on a <a href="../configuration/collections">Collection</a> automatically exposes additional auth-based operations in the <a href="../local-api/overview">Local API</a>, <a href="../rest-api/overview">REST API</a>, and <a href="../graphql/overview">GraphQL API</a>.</p>
<h2>Access</h2>
<p>The Access operation returns what a logged in user can and can&#x27;t do with the collections and globals that are registered via your config. This data can be immensely helpful if your app needs to show and hide certain features based on <a href="../access-control/overview">Access Control</a>, just as the <a href="../admin/overview">Admin Panel</a> does.</p>
<p><strong>REST API endpoint</strong>:</p>
<p><code>GET http://localhost:3000/api/access</code></p>
<p>Example response:</p>
<pre><code class="language-ts">{
  canAccessAdmin: true,
  collections: {
    pages: {
      create: {
        permission: true,
      },
      read: {
        permission: true,
      },
      update: {
        permission: true,
      },
      delete: {
        permission: true,
      },
      fields: {
        title: {
          create: {
            permission: true,
          },
          read: {
            permission: true,
          },
          update: {
            permission: true,
          },
        }
      }
    }
  }
}
</code></pre>
<p><strong>Example GraphQL Query</strong>:</p>
<pre><code class="language-graphql">query {
  Access {
    pages {
      read {
        permission
      }
    }
  }
}
</code></pre>
<p>Document access can also be queried on a collection/global basis. Access on a global can queried like <code>http://localhost:3000/api/global-slug/access</code>, Collection document access can be queried like <code>http://localhost:3000/api/collection-slug/access/:id</code>.</p>
<h2>Me</h2>
<p>Returns either a logged in user with token or null when there is no logged in user.</p>
<p><strong>REST API endpoint</strong>:</p>
<p><code>GET http://localhost:3000/api/[collection-slug]/me</code></p>
<p>Example response:</p>
<pre><code class="language-ts">{
  user: { // The JWT &quot;payload&quot; ;) from the logged in user
    email: &#x27;dev@payloadcms.com&#x27;,
    createdAt: &quot;2020-12-27T21:16:45.645Z&quot;,
    updatedAt: &quot;2021-01-02T18:37:41.588Z&quot;,
    id: &quot;5ae8f9bde69e394e717c8832&quot;
  },
  token: &#x27;34o4345324...&#x27;, // The token that can be used to authenticate the user
  exp: 1609619861, // Unix timestamp representing when the user&#x27;s token will expire
}
</code></pre>
<p><strong>Example GraphQL Query</strong>:</p>
<pre><code class="language-graphql">query {
  me[collection-singular-label] {
    user {
      email
    }
    exp
  }
}
</code></pre>
<h2>Login</h2>
<p>Accepts an <code>email</code> and <code>password</code>. On success, it will return the logged in user as well as a token that can be used to authenticate. In the GraphQL and REST APIs, this operation also automatically sets an HTTP-only cookie including the user&#x27;s token. If you pass a <code>res</code> to the Local API operation, Payload will set a cookie there as well.</p>
<p><strong>Example REST API login</strong>:</p>
<pre><code class="language-ts">const res = await fetch(&#x27;http://localhost:3000/api/[collection-slug]/login&#x27;, {
  method: &#x27;POST&#x27;,
  headers: {
    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
  },
  body: JSON.stringify({
    email: &#x27;dev@payloadcms.com&#x27;,
    password: &#x27;this-is-not-our-password...or-is-it?&#x27;,
  }),
})

const json = await res.json()

// JSON will be equal to the following:
/*
{
  user: {
    email: &#x27;dev@payloadcms.com&#x27;,
    createdAt: &quot;2020-12-27T21:16:45.645Z&quot;,
    updatedAt: &quot;2021-01-02T18:37:41.588Z&quot;,
    id: &quot;5ae8f9bde69e394e717c8832&quot;
  },
  token: &#x27;34o4345324...&#x27;,
  exp: 1609619861
}
*/
</code></pre>
<p><strong>Example GraphQL Mutation</strong>:</p>
<pre><code class="language-graphql">mutation {
  login[collection-singular-label](email: &quot;dev@payloadcms.com&quot;, password: &quot;yikes&quot;) {
    user {
      email
    }
    exp
    token
  }
}
</code></pre>
<p><strong>Example Local API login</strong>:</p>
<pre><code class="language-ts">const result = await payload.login({
  collection: &#x27;[collection-slug]&#x27;,
  data: {
    email: &#x27;dev@payloadcms.com&#x27;,
    password: &#x27;get-out&#x27;,
  },
})
</code></pre>
<h2>Logout</h2>
<p>As Payload sets HTTP-only cookies, logging out cannot be done by just removing a cookie in JavaScript, as HTTP-only cookies are inaccessible by JS within the browser. So, Payload exposes a <code>logout</code> operation to delete the token in a safe way.</p>
<p><strong>Example REST API logout</strong>:</p>
<pre><code class="language-ts">const res = await fetch(&#x27;http://localhost:3000/api/[collection-slug]/logout&#x27;, {
  method: &#x27;POST&#x27;,
  headers: {
    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
  },
})
</code></pre>
<p><strong>Example GraphQL Mutation</strong>:</p>
<pre><code>mutation {
  logout[collection-singular-label]
}
</code></pre>
<h2>Refresh</h2>
<p>Allows for &quot;refreshing&quot; JWTs. If your user has a token that is about to expire, but the user is still active and using the app, you might want to use the <code>refresh</code> operation to receive a new token by executing this operation via the authenticated user.</p>
<p>This operation requires a non-expired token to send back a new one. If the user&#x27;s token has already expired, you will need to allow them to log in again to retrieve a new token.</p>
<p>If successful, this operation will automatically renew the user&#x27;s HTTP-only cookie and will send back the updated token in JSON.</p>
<p><strong>Example REST API token refresh</strong>:</p>
<pre><code class="language-ts">const res = await fetch(
  &#x27;http://localhost:3000/api/[collection-slug]/refresh-token&#x27;,
  {
    method: &#x27;POST&#x27;,
    headers: {
      &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
    },
  },
)

const json = await res.json()

// JSON will be equal to the following:
/*
{
  user: {
    email: &#x27;dev@payloadcms.com&#x27;,
    createdAt: &quot;2020-12-27T21:16:45.645Z&quot;,
    updatedAt: &quot;2021-01-02T18:37:41.588Z&quot;,
    id: &quot;5ae8f9bde69e394e717c8832&quot;
  },
  refreshedToken: &#x27;34o4345324...&#x27;,
  exp: 1609619861
}
*/
</code></pre>
<p><strong>Example GraphQL Mutation</strong>:</p>
<pre><code>mutation {
  refreshToken[collection-singular-label] {
    user {
      email
    }
    refreshedToken
  }
}
</code></pre>
<h2>Verify by Email</h2>
<p>If your collection supports email verification, the Verify operation will be exposed which accepts a verification token and sets the user&#x27;s <code>_verified</code> property to <code>true</code>, thereby allowing the user to authenticate with the Payload API.</p>
<p><strong>Example REST API user verification</strong>:</p>
<pre><code class="language-ts">const res = await fetch(
  `http://localhost:3000/api/[collection-slug]/verify/${TOKEN_HERE}`,
  {
    method: &#x27;POST&#x27;,
    headers: {
      &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
    },
  },
)
</code></pre>
<p><strong>Example GraphQL Mutation</strong>:</p>
<pre><code class="language-graphql">mutation {
  verifyEmail[collection-singular-label](token: &quot;TOKEN_HERE&quot;)
}
</code></pre>
<p><strong>Example Local API verification</strong>:</p>
<pre><code class="language-ts">const result = await payload.verifyEmail({
  collection: &#x27;[collection-slug]&#x27;,
  token: &#x27;TOKEN_HERE&#x27;,
})
</code></pre>
<p><strong>Note:</strong> the token you need to pass to the <code>verifyEmail</code> function is unique to verification and is not the same as the token that you can retrieve from the <code>forgotPassword</code> operation. It can be found on the user document, as a hidden <code>_verificationToken</code> field. If you&#x27;d like to retrieve this token, you can use the Local API&#x27;s <code>find</code> or <code>findByID</code> methods, setting <code>showHiddenFields: true</code>.</p>
<p><strong>Note:</strong> if you do not have a <code>config.serverURL</code> set, Payload will attempt to create one for you if the user was created via REST or GraphQL by looking at the incoming <code>req</code>. But this is not supported if you are creating the user via the Local API&#x27;s <code>payload.create()</code> method. If this applies to you, and you do not have a <code>serverURL</code> set, you may want to override your <code>verify.generateEmailHTML</code> function to provide a full URL to link the user to a proper verification page.</p>
<h2>Unlock</h2>
<p>If a user locks themselves out and you wish to deliberately unlock them, you can utilize the Unlock operation. The <a href="../admin/overview">Admin Panel</a> features an Unlock control automatically for all collections that feature max login attempts, but you can programmatically unlock users as well by using the Unlock operation.</p>
<p>To restrict who is allowed to unlock users, you can utilize the <a href="../access-control/collections#unlock"><code>unlock</code></a> access control function.</p>
<p><strong>Example REST API unlock</strong>:</p>
<pre><code class="language-ts">const res = await fetch(`http://localhost:3000/api/[collection-slug]/unlock`, {
  method: &#x27;POST&#x27;,
  headers: {
    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
  },
})
</code></pre>
<p><strong>Example GraphQL Mutation</strong>:</p>
<pre><code>mutation {
  unlock[collection-singular-label]
}
</code></pre>
<p><strong>Example Local API unlock</strong>:</p>
<pre><code class="language-ts">const result = await payload.unlock({
  collection: &#x27;[collection-slug]&#x27;,
})
</code></pre>
<h2>Forgot Password</h2>
<p>Payload comes with built-in forgot password functionality. Submitting an email address to the Forgot Password operation will generate an email and send it to the respective email address with a link to reset their password.</p>
<p>The link to reset the user&#x27;s password contains a token which is what allows the user to securely reset their password.</p>
<p>By default, the Forgot Password operations send users to the <a href="../admin/overview">Admin Panel</a> to reset their password, but you can customize the generated email to send users to the frontend of your app instead by <a href="/payload-just-docs/docs/authentication/email#forgot-password">overriding the email HTML</a>.</p>
<p><strong>Example REST API Forgot Password</strong>:</p>
<pre><code class="language-ts">const res = await fetch(
  `http://localhost:3000/api/[collection-slug]/forgot-password`,
  {
    method: &#x27;POST&#x27;,
    headers: {
      &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
    },
    body: JSON.stringify({
      email: &#x27;dev@payloadcms.com&#x27;,
    }),
  },
)
</code></pre>
<p><strong>Example GraphQL Mutation</strong>:</p>
<pre><code>mutation {
  forgotPassword[collection-singular-label](email: &quot;dev@payloadcms.com&quot;)
}
</code></pre>
<p><strong>Example Local API forgot password</strong>:</p>
<pre><code class="language-ts">const token = await payload.forgotPassword({
  collection: &#x27;[collection-slug]&#x27;,
  data: {
    email: &#x27;dev@payloadcms.com&#x27;,
  },
  disableEmail: false, // you can disable the auto-generation of email via Local API
})
</code></pre>
<div class="p-4 my-4 rounded-lg border bg-blue-50 border-blue-200 text-blue-800"><svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><p><strong>Note:</strong> if you do not have a <code>config.serverURL</code> set, Payload will attempt to
create one for you if the <code>forgot-password</code> operation was triggered via REST
or GraphQL by looking at the incoming <code>req</code>. But this is not supported if you
are calling <code>payload.forgotPassword()</code> via the Local API. If you do not have a
<code>serverURL</code> set, you may want to override your
<code>auth.forgotPassword.generateEmailHTML</code> function to provide a full URL to link
the user to a proper reset-password page.</p></div>
<div class="p-4 my-4 rounded-lg border bg-green-50 border-green-200 text-green-800"><svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg><p><strong>Tip:</strong></p><p>You can stop the reset-password email from being sent via using the Local API. This is helpful if
you need to create user accounts programmatically, but not set their password for them. This
effectively generates a reset password token which you can then use to send to a page you create,
allowing a user to &quot;complete&quot; their account by setting their password. In the background, you&#x27;d
use the token to &quot;reset&quot; their password.</p></div>
<h2>Reset Password</h2>
<p>After a user has &quot;forgotten&quot; their password and a token is generated, that token can be used to send to the reset password operation along with a new password which will allow the user to reset their password securely.</p>
<p><strong>Example REST API Reset Password</strong>:</p>
<pre><code class="language-ts">const res = await fetch(`http://localhost:3000/api/[collection-slug]/reset-password`, {
  method: &#x27;POST&#x27;,
  headers: {
    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
  },
  body: JSON.stringify({
    token: &#x27;TOKEN_GOES_HERE&#x27;
    password: &#x27;not-today&#x27;,
  }),
});

const json = await res.json();

// JSON will be equal to the following:
/*
{
  user: {
    email: &#x27;dev@payloadcms.com&#x27;,
    createdAt: &quot;2020-12-27T21:16:45.645Z&quot;,
    updatedAt: &quot;2021-01-02T18:37:41.588Z&quot;,
    id: &quot;5ae8f9bde69e394e717c8832&quot;
  },
  token: &#x27;34o4345324...&#x27;,
  exp: 1609619861
}
*/
</code></pre>
<p><strong>Example GraphQL Mutation</strong>:</p>
<pre><code class="language-graphql">mutation {
  resetPassword[collection-singular-label](token: &quot;TOKEN_GOES_HERE&quot;, password: &quot;not-today&quot;)
}
</code></pre></div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"frontMatter":{"title":"Authentication Operations","label":"Operations","order":20,"desc":"Enabling Authentication automatically makes key operations available such as Login, Logout, Verify, Unlock, Reset Password and more.","keywords":"authentication, config, configuration, documentation, Content Management System, cms, headless, javascript, node, react, nextjs"},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    h2: \"h2\",\n    strong: \"strong\",\n    code: \"code\",\n    pre: \"pre\"\n  }, _provideComponents(), props.components), {Banner} = _components;\n  if (!Banner) _missingMdxReference(\"Banner\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"Enabling \", _jsx(_components.a, {\n        href: \"./overview\",\n        children: \"Authentication\"\n      }), \" on a \", _jsx(_components.a, {\n        href: \"../configuration/collections\",\n        children: \"Collection\"\n      }), \" automatically exposes additional auth-based operations in the \", _jsx(_components.a, {\n        href: \"../local-api/overview\",\n        children: \"Local API\"\n      }), \", \", _jsx(_components.a, {\n        href: \"../rest-api/overview\",\n        children: \"REST API\"\n      }), \", and \", _jsx(_components.a, {\n        href: \"../graphql/overview\",\n        children: \"GraphQL API\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Access\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The Access operation returns what a logged in user can and can't do with the collections and globals that are registered via your config. This data can be immensely helpful if your app needs to show and hide certain features based on \", _jsx(_components.a, {\n        href: \"../access-control/overview\",\n        children: \"Access Control\"\n      }), \", just as the \", _jsx(_components.a, {\n        href: \"../admin/overview\",\n        children: \"Admin Panel\"\n      }), \" does.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"REST API endpoint\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.code, {\n        children: \"GET http://localhost:3000/api/access\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Example response:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"{\\n  canAccessAdmin: true,\\n  collections: {\\n    pages: {\\n      create: {\\n        permission: true,\\n      },\\n      read: {\\n        permission: true,\\n      },\\n      update: {\\n        permission: true,\\n      },\\n      delete: {\\n        permission: true,\\n      },\\n      fields: {\\n        title: {\\n          create: {\\n            permission: true,\\n          },\\n          read: {\\n            permission: true,\\n          },\\n          update: {\\n            permission: true,\\n          },\\n        }\\n      }\\n    }\\n  }\\n}\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example GraphQL Query\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-graphql\",\n        children: \"query {\\n  Access {\\n    pages {\\n      read {\\n        permission\\n      }\\n    }\\n  }\\n}\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Document access can also be queried on a collection/global basis. Access on a global can queried like \", _jsx(_components.code, {\n        children: \"http://localhost:3000/api/global-slug/access\"\n      }), \", Collection document access can be queried like \", _jsx(_components.code, {\n        children: \"http://localhost:3000/api/collection-slug/access/:id\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Me\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Returns either a logged in user with token or null when there is no logged in user.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"REST API endpoint\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.code, {\n        children: \"GET http://localhost:3000/api/[collection-slug]/me\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Example response:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"{\\n  user: { // The JWT \\\"payload\\\" ;) from the logged in user\\n    email: 'dev@payloadcms.com',\\n    createdAt: \\\"2020-12-27T21:16:45.645Z\\\",\\n    updatedAt: \\\"2021-01-02T18:37:41.588Z\\\",\\n    id: \\\"5ae8f9bde69e394e717c8832\\\"\\n  },\\n  token: '34o4345324...', // The token that can be used to authenticate the user\\n  exp: 1609619861, // Unix timestamp representing when the user's token will expire\\n}\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example GraphQL Query\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-graphql\",\n        children: \"query {\\n  me[collection-singular-label] {\\n    user {\\n      email\\n    }\\n    exp\\n  }\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Login\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Accepts an \", _jsx(_components.code, {\n        children: \"email\"\n      }), \" and \", _jsx(_components.code, {\n        children: \"password\"\n      }), \". On success, it will return the logged in user as well as a token that can be used to authenticate. In the GraphQL and REST APIs, this operation also automatically sets an HTTP-only cookie including the user's token. If you pass a \", _jsx(_components.code, {\n        children: \"res\"\n      }), \" to the Local API operation, Payload will set a cookie there as well.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example REST API login\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const res = await fetch('http://localhost:3000/api/[collection-slug]/login', {\\n  method: 'POST',\\n  headers: {\\n    'Content-Type': 'application/json',\\n  },\\n  body: JSON.stringify({\\n    email: 'dev@payloadcms.com',\\n    password: 'this-is-not-our-password...or-is-it?',\\n  }),\\n})\\n\\nconst json = await res.json()\\n\\n// JSON will be equal to the following:\\n/*\\n{\\n  user: {\\n    email: 'dev@payloadcms.com',\\n    createdAt: \\\"2020-12-27T21:16:45.645Z\\\",\\n    updatedAt: \\\"2021-01-02T18:37:41.588Z\\\",\\n    id: \\\"5ae8f9bde69e394e717c8832\\\"\\n  },\\n  token: '34o4345324...',\\n  exp: 1609619861\\n}\\n*/\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example GraphQL Mutation\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-graphql\",\n        children: \"mutation {\\n  login[collection-singular-label](email: \\\"dev@payloadcms.com\\\", password: \\\"yikes\\\") {\\n    user {\\n      email\\n    }\\n    exp\\n    token\\n  }\\n}\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example Local API login\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const result = await payload.login({\\n  collection: '[collection-slug]',\\n  data: {\\n    email: 'dev@payloadcms.com',\\n    password: 'get-out',\\n  },\\n})\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Logout\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"As Payload sets HTTP-only cookies, logging out cannot be done by just removing a cookie in JavaScript, as HTTP-only cookies are inaccessible by JS within the browser. So, Payload exposes a \", _jsx(_components.code, {\n        children: \"logout\"\n      }), \" operation to delete the token in a safe way.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example REST API logout\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const res = await fetch('http://localhost:3000/api/[collection-slug]/logout', {\\n  method: 'POST',\\n  headers: {\\n    'Content-Type': 'application/json',\\n  },\\n})\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example GraphQL Mutation\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"mutation {\\n  logout[collection-singular-label]\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Refresh\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Allows for \\\"refreshing\\\" JWTs. If your user has a token that is about to expire, but the user is still active and using the app, you might want to use the \", _jsx(_components.code, {\n        children: \"refresh\"\n      }), \" operation to receive a new token by executing this operation via the authenticated user.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This operation requires a non-expired token to send back a new one. If the user's token has already expired, you will need to allow them to log in again to retrieve a new token.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"If successful, this operation will automatically renew the user's HTTP-only cookie and will send back the updated token in JSON.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example REST API token refresh\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const res = await fetch(\\n  'http://localhost:3000/api/[collection-slug]/refresh-token',\\n  {\\n    method: 'POST',\\n    headers: {\\n      'Content-Type': 'application/json',\\n    },\\n  },\\n)\\n\\nconst json = await res.json()\\n\\n// JSON will be equal to the following:\\n/*\\n{\\n  user: {\\n    email: 'dev@payloadcms.com',\\n    createdAt: \\\"2020-12-27T21:16:45.645Z\\\",\\n    updatedAt: \\\"2021-01-02T18:37:41.588Z\\\",\\n    id: \\\"5ae8f9bde69e394e717c8832\\\"\\n  },\\n  refreshedToken: '34o4345324...',\\n  exp: 1609619861\\n}\\n*/\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example GraphQL Mutation\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"mutation {\\n  refreshToken[collection-singular-label] {\\n    user {\\n      email\\n    }\\n    refreshedToken\\n  }\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Verify by Email\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If your collection supports email verification, the Verify operation will be exposed which accepts a verification token and sets the user's \", _jsx(_components.code, {\n        children: \"_verified\"\n      }), \" property to \", _jsx(_components.code, {\n        children: \"true\"\n      }), \", thereby allowing the user to authenticate with the Payload API.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example REST API user verification\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const res = await fetch(\\n  `http://localhost:3000/api/[collection-slug]/verify/${TOKEN_HERE}`,\\n  {\\n    method: 'POST',\\n    headers: {\\n      'Content-Type': 'application/json',\\n    },\\n  },\\n)\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example GraphQL Mutation\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-graphql\",\n        children: \"mutation {\\n  verifyEmail[collection-singular-label](token: \\\"TOKEN_HERE\\\")\\n}\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example Local API verification\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const result = await payload.verifyEmail({\\n  collection: '[collection-slug]',\\n  token: 'TOKEN_HERE',\\n})\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Note:\"\n      }), \" the token you need to pass to the \", _jsx(_components.code, {\n        children: \"verifyEmail\"\n      }), \" function is unique to verification and is not the same as the token that you can retrieve from the \", _jsx(_components.code, {\n        children: \"forgotPassword\"\n      }), \" operation. It can be found on the user document, as a hidden \", _jsx(_components.code, {\n        children: \"_verificationToken\"\n      }), \" field. If you'd like to retrieve this token, you can use the Local API's \", _jsx(_components.code, {\n        children: \"find\"\n      }), \" or \", _jsx(_components.code, {\n        children: \"findByID\"\n      }), \" methods, setting \", _jsx(_components.code, {\n        children: \"showHiddenFields: true\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Note:\"\n      }), \" if you do not have a \", _jsx(_components.code, {\n        children: \"config.serverURL\"\n      }), \" set, Payload will attempt to create one for you if the user was created via REST or GraphQL by looking at the incoming \", _jsx(_components.code, {\n        children: \"req\"\n      }), \". But this is not supported if you are creating the user via the Local API's \", _jsx(_components.code, {\n        children: \"payload.create()\"\n      }), \" method. If this applies to you, and you do not have a \", _jsx(_components.code, {\n        children: \"serverURL\"\n      }), \" set, you may want to override your \", _jsx(_components.code, {\n        children: \"verify.generateEmailHTML\"\n      }), \" function to provide a full URL to link the user to a proper verification page.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Unlock\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If a user locks themselves out and you wish to deliberately unlock them, you can utilize the Unlock operation. The \", _jsx(_components.a, {\n        href: \"../admin/overview\",\n        children: \"Admin Panel\"\n      }), \" features an Unlock control automatically for all collections that feature max login attempts, but you can programmatically unlock users as well by using the Unlock operation.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"To restrict who is allowed to unlock users, you can utilize the \", _jsx(_components.a, {\n        href: \"../access-control/collections#unlock\",\n        children: _jsx(_components.code, {\n          children: \"unlock\"\n        })\n      }), \" access control function.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example REST API unlock\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const res = await fetch(`http://localhost:3000/api/[collection-slug]/unlock`, {\\n  method: 'POST',\\n  headers: {\\n    'Content-Type': 'application/json',\\n  },\\n})\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example GraphQL Mutation\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"mutation {\\n  unlock[collection-singular-label]\\n}\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example Local API unlock\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const result = await payload.unlock({\\n  collection: '[collection-slug]',\\n})\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Forgot Password\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Payload comes with built-in forgot password functionality. Submitting an email address to the Forgot Password operation will generate an email and send it to the respective email address with a link to reset their password.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The link to reset the user's password contains a token which is what allows the user to securely reset their password.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"By default, the Forgot Password operations send users to the \", _jsx(_components.a, {\n        href: \"../admin/overview\",\n        children: \"Admin Panel\"\n      }), \" to reset their password, but you can customize the generated email to send users to the frontend of your app instead by \", _jsx(_components.a, {\n        href: \"/docs/authentication/email#forgot-password\",\n        children: \"overriding the email HTML\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example REST API Forgot Password\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const res = await fetch(\\n  `http://localhost:3000/api/[collection-slug]/forgot-password`,\\n  {\\n    method: 'POST',\\n    headers: {\\n      'Content-Type': 'application/json',\\n    },\\n    body: JSON.stringify({\\n      email: 'dev@payloadcms.com',\\n    }),\\n  },\\n)\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example GraphQL Mutation\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"mutation {\\n  forgotPassword[collection-singular-label](email: \\\"dev@payloadcms.com\\\")\\n}\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example Local API forgot password\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const token = await payload.forgotPassword({\\n  collection: '[collection-slug]',\\n  data: {\\n    email: 'dev@payloadcms.com',\\n  },\\n  disableEmail: false, // you can disable the auto-generation of email via Local API\\n})\\n\"\n      })\n    }), \"\\n\", _jsx(Banner, {\n      type: \"info\",\n      children: _jsxs(_components.p, {\n        children: [_jsx(_components.strong, {\n          children: \"Note:\"\n        }), \" if you do not have a \", _jsx(_components.code, {\n          children: \"config.serverURL\"\n        }), \" set, Payload will attempt to\\ncreate one for you if the \", _jsx(_components.code, {\n          children: \"forgot-password\"\n        }), \" operation was triggered via REST\\nor GraphQL by looking at the incoming \", _jsx(_components.code, {\n          children: \"req\"\n        }), \". But this is not supported if you\\nare calling \", _jsx(_components.code, {\n          children: \"payload.forgotPassword()\"\n        }), \" via the Local API. If you do not have a\\n\", _jsx(_components.code, {\n          children: \"serverURL\"\n        }), \" set, you may want to override your\\n\", _jsx(_components.code, {\n          children: \"auth.forgotPassword.generateEmailHTML\"\n        }), \" function to provide a full URL to link\\nthe user to a proper reset-password page.\"]\n      })\n    }), \"\\n\", _jsxs(Banner, {\n      type: \"success\",\n      children: [_jsx(_components.p, {\n        children: _jsx(_components.strong, {\n          children: \"Tip:\"\n        })\n      }), _jsx(_components.p, {\n        children: \"You can stop the reset-password email from being sent via using the Local API. This is helpful if\\nyou need to create user accounts programmatically, but not set their password for them. This\\neffectively generates a reset password token which you can then use to send to a page you create,\\nallowing a user to \\\"complete\\\" their account by setting their password. In the background, you'd\\nuse the token to \\\"reset\\\" their password.\"\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Reset Password\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"After a user has \\\"forgotten\\\" their password and a token is generated, that token can be used to send to the reset password operation along with a new password which will allow the user to reset their password securely.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example REST API Reset Password\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const res = await fetch(`http://localhost:3000/api/[collection-slug]/reset-password`, {\\n  method: 'POST',\\n  headers: {\\n    'Content-Type': 'application/json',\\n  },\\n  body: JSON.stringify({\\n    token: 'TOKEN_GOES_HERE'\\n    password: 'not-today',\\n  }),\\n});\\n\\nconst json = await res.json();\\n\\n// JSON will be equal to the following:\\n/*\\n{\\n  user: {\\n    email: 'dev@payloadcms.com',\\n    createdAt: \\\"2020-12-27T21:16:45.645Z\\\",\\n    updatedAt: \\\"2021-01-02T18:37:41.588Z\\\",\\n    id: \\\"5ae8f9bde69e394e717c8832\\\"\\n  },\\n  token: '34o4345324...',\\n  exp: 1609619861\\n}\\n*/\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Example GraphQL Mutation\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-graphql\",\n        children: \"mutation {\\n  resetPassword[collection-singular-label](token: \\\"TOKEN_GOES_HERE\\\", password: \\\"not-today\\\")\\n}\\n\"\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/docs/[...slug]","query":{"slug":["authentication","operations"]},"buildId":"_tTBTu5tMI_qrBgEpmt0H","assetPrefix":"/payload-just-docs","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>