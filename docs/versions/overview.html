<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/payload-just-docs/_next/static/css/adeeaed65336a824.css" as="style" crossorigin=""/><link rel="stylesheet" href="/payload-just-docs/_next/static/css/adeeaed65336a824.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/payload-just-docs/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/payload-just-docs/_next/static/chunks/webpack-c335844537ee4527.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/framework-fae63b21a27d6472.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/main-4b5290d5009800e1.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/pages/_app-2747846ed27f1501.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/pages/docs/%5B...slug%5D-e023289636109d90.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/pbayt_BRhSN28J-gcoKlf/_buildManifest.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/pbayt_BRhSN28J-gcoKlf/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><div class="container mx-auto px-4 py-8 max-w-4xl"><h1 class="text-4xl font-bold mb-4">Versions</h1><p class="text-xl text-gray-600 mb-8">Keep a version history or audit log of changes and publish collection documents and globals.</p><div class="prose prose-lg max-w-none"><div class="p-4 my-4 rounded-lg border bg-blue-50 border-blue-200 text-blue-800"><svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><p>Payload&#x27;s powerful Versions functionality allows you to keep a running history
of changes over time and extensible to fit any content publishing workflow.</p></div>
<p>When enabled, Payload will automatically scaffold a new Collection in your database to store versions of your document(s) over time, and the Admin UI will be extended with additional views that allow you to browse document versions, view diffs in order to see exactly what has changed in your documents (and when they changed), and restore documents back to prior versions easily.</p>
<p><img src="/images/docs/versions.png" alt="Versions"/>
<em>Comparing an old version to a newer version of a document</em></p>
<p><strong>With Versions, you can:</strong></p>
<ul>
<li>Maintain an audit log / history of every change ever made to a document, including monitoring for what user made which change</li>
<li>Restore documents and globals to prior states in case you need to roll back changes</li>
<li>Build a true <a href="/docs/versions/drafts">Draft Preview</a> mode for your data</li>
<li>Manage who can see Drafts, and who can only see Published documents via <a href="/docs/access-control/overview">Access Control</a></li>
<li>Enable <a href="/docs/versions/autosave">Autosave</a> on collections and globals to never lose your work again</li>
<li>Build a powerful publishing schedule mechanism to create documents and have them become publicly readable automatically at a future date</li>
</ul>
<div class="p-4 my-4 rounded-lg border bg-green-50 border-green-200 text-green-800"><svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg><p>Versions are extremely performant and totally opt-in. They don&#x27;t change the
shape of your data at all. All versions are stored in a separate Collection
and can be turned on and off easily at your discretion.</p></div>
<h2>Options</h2>
<p>Versions support a few different levels of functionality that each come with their own impacts to document workflow.</p>
<h3>Versions enabled, drafts disabled</h3>
<p>If you enable versions but keep draft mode disabled, Payload will simply create a new version of a document each time you update a document. This is great for use cases where you need to retain a history of all document updates over time, but always want to treat the newest document version as the version that is &quot;published&quot;.</p>
<p>For example, a use case for &quot;versions enabled, drafts disabled&quot; could be on a collection of users, where you might want to keep a version history (or audit log) of all changes ever made to users - but any changes to users should <em>always</em> be treated as &quot;published&quot; and you have no need to maintain a &quot;draft&quot; version of a user.</p>
<h3>Versions and drafts enabled</h3>
<p>If you have versions <em>and</em> drafts enabled, you are able to control which documents are published, and which are considered draft. That lets you write <a href="../access-control/overview">Access Control</a> to control who can see published documents, and who can see draft documents. It also lets you save versions (drafts) that are <em>newer</em> than your most recently published document, which is helpful if you want to draft changes and maybe even preview them before you publish the changes. Read more about Drafts <a href="/docs/versions/drafts">here</a>.</p>
<h3>Versions, drafts, and autosave enabled</h3>
<p>When you have versions, drafts, <em>and</em> <code>autosave</code> enabled, the Admin UI will automatically save changes that you make to a new <code>draft</code> version as you edit a document, which makes sure that you never lose your changes ever again. Autosave will not affect your published post at all—instead, it&#x27;ll just save your changes and let you publish them whenever you or your editors are ready to do so. Read more about Autosave <a href="/docs/versions/autosave">here</a>.</p>
<h2>Collection config</h2>
<p>Configuring Versions is done by adding the <code>versions</code> key to your Collection configs. Set it to <code>true</code> to enable default Versions settings, or customize versions options by setting the property equal to an object containing the following available options:</p>
<div class="overflow-x-auto my-8"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr class="even:bg-gray-50"><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Option</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>maxPerDoc</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Use this setting to control how many versions to keep on a document by document basis. Must be an integer. Defaults to 100, use 0 to save all versions.</td></tr><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>drafts</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Enable <a href="/docs/versions/drafts">Drafts</a> mode for this collection. To enable, set to <code>true</code> or pass an object with <code>draft</code> <a href="/docs/versions/drafts#options">options</a>.</td></tr></tbody></table></div>
<h2>Global config</h2>
<p>Global versions work similarly to Collection versions but have a slightly different set of config properties supported.</p>
<div class="overflow-x-auto my-8"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr class="even:bg-gray-50"><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Option</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>max</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Use this setting to control how many versions to keep on a global by global basis. Must be an integer.</td></tr><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>drafts</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Enable <a href="/docs/versions/drafts">Drafts</a> mode for this global. To enable, set to <code>true</code> or pass an object with <code>draft</code> <a href="/docs/versions/drafts#options">options</a></td></tr></tbody></table></div>
<h3>Database impact</h3>
<p>By enabling <code>versions</code>, a new database collection will be made to store versions for your collection or global. The collection will be named based off the <code>slug</code> of the collection or global and will follow this pattern (where <code>slug</code> is replaced with the <code>slug</code> of your collection or global):</p>
<pre><code>_slug_versions
</code></pre>
<p>Each document in this new <code>versions</code> collection will store a set of meta properties about the version as well as a <em>full</em> copy of the document. For example, a version&#x27;s data might look like this for a Collection document:</p>
<pre><code class="language-json">{
  &quot;_id&quot;: &quot;61cf752c19cdf1b1af7b61f1&quot;, // a unique ID of this version
  &quot;parent&quot;: &quot;61ce1354091d5b3ffc20ea6e&quot;, // the ID of the parent document
  &quot;autosave&quot;: false, // used to denote if this version was created via autosave
  &quot;version&quot;: {
    // your document&#x27;s data goes here
    // all fields are set to not required and this property can be partially complete
  },
  &quot;createdAt&quot;: &quot;2021-12-31T21:25:00.992+00:00&quot;,
  &quot;updatedAt&quot;: &quot;2021-12-31T21:25:00.992+00:00&quot;
}
</code></pre>
<p>Global versions are stored the same as the collection version shown above, except they do not feature the <code>parent</code> property, as each Global receives its own <code>versions</code> collection. That means we know that all versions in that collection correspond to that specific global.</p>
<h2>Version operations</h2>
<p>Versions expose new operations for both collections and globals. They allow you to find and query versions, find a single version by ID, and publish (or restore) a version by ID. Both Collections and Globals support the same new operations. They are used primarily by the admin UI, but if you are writing custom logic in your app and would like to utilize them, they&#x27;re available for you to use as well via REST, GraphQL, and Local APIs.</p>
<p><strong>Collection REST endpoints:</strong></p>
<div class="overflow-x-auto my-8"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr class="even:bg-gray-50"><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Method</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Path</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>GET</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>/api/{collectionSlug}/versions</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Find and query paginated versions</td></tr><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>GET</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>/api/{collectionSlug}/versions/:id</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Find a specific version by ID</td></tr><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>POST</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>/api/{collectionSlug}/versions/:id</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Restore a version by ID</td></tr></tbody></table></div>
<p><strong>Collection GraphQL queries:</strong></p>
<div class="overflow-x-auto my-8"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr class="even:bg-gray-50"><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Query Name</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Operation</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><strong><code>version{collection.label.singular}</code></strong></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>findVersionByID</code></td></tr><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><strong><code>versions{collection.label.plural}</code></strong></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>findVersions</code></td></tr></tbody></table></div>
<p><strong>And mutation:</strong></p>
<div class="overflow-x-auto my-8"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr class="even:bg-gray-50"><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Query Name</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Operation</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><strong><code>restoreVersion{collection.label.singular}</code></strong></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>restoreVersion</code></td></tr></tbody></table></div>
<p><strong>Collection Local API methods:</strong></p>
<h3>Find</h3>
<pre><code class="language-js">// Result will be a paginated set of Versions.
// See /docs/queries/pagination for more.
const result = await payload.findVersions({
  collection: &#x27;posts&#x27;, // required
  depth: 2,
  page: 1,
  limit: 10,
  where: {}, // pass a `where` query here
  sort: &#x27;-createdAt&#x27;,
  locale: &#x27;en&#x27;,
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  showHiddenFields: true,
})
</code></pre>
<h3>Find by ID</h3>
<pre><code class="language-js">// Result will be a Post document.
const result = await payload.findVersionByID({
  collection: &#x27;posts&#x27;, // required
  id: &#x27;507f1f77bcf86cd799439013&#x27;, // required
  depth: 2,
  locale: &#x27;en&#x27;,
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  showHiddenFields: true,
})
</code></pre>
<h3>Restore</h3>
<pre><code class="language-js">// Result will be the restored global document.
const result = await payload.restoreVersion({
  collection: &#x27;posts&#x27;, // required
  id: &#x27;507f1f77bcf86cd799439013&#x27;, // required
  depth: 2,
  user: dummyUser,
  overrideAccess: false,
  showHiddenFields: true,
})
</code></pre>
<p><strong>Global REST endpoints:</strong></p>
<div class="overflow-x-auto my-8"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr class="even:bg-gray-50"><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Method</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Path</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>GET</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>/api/globals/{globalSlug}/versions</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Find and query paginated versions</td></tr><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>GET</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>/api/globals/{globalSlug}/versions/:id</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Find a specific version by ID</td></tr><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>POST</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>/api/globals/{globalSlug}/versions/:id</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Restore a version by ID</td></tr></tbody></table></div>
<p><strong>Global GraphQL queries:</strong></p>
<div class="overflow-x-auto my-8"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr class="even:bg-gray-50"><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Query Name</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Operation</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><strong><code>version{global.label}</code></strong></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>findVersionByID</code></td></tr><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><strong><code>versions{global.label}</code></strong></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>findVersions</code></td></tr></tbody></table></div>
<p><strong>Global GraphQL mutation:</strong></p>
<div class="overflow-x-auto my-8"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr class="even:bg-gray-50"><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Query Name</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Operation</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><strong><code>restoreVersion{global.label}</code></strong></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>restoreVersion</code></td></tr></tbody></table></div>
<p><strong>Global Local API methods:</strong></p>
<h3>Find</h3>
<pre><code class="language-js">// Result will be a paginated set of Versions.
// See /docs/queries/pagination for more.
const result = await payload.findGlobalVersions({
  slug: &#x27;header&#x27;, // required
  depth: 2,
  page: 1,
  limit: 10,
  where: {}, // pass a `where` query here
  sort: &#x27;-createdAt&#x27;,
  locale: &#x27;en&#x27;,
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  showHiddenFields: true,
})
</code></pre>
<h3>Find by ID</h3>
<pre><code class="language-js">// Result will be a Post document.
const result = await payload.findGlobalVersionByID({
  slug: &#x27;header&#x27;, // required
  id: &#x27;507f1f77bcf86cd799439013&#x27;, // required
  depth: 2,
  locale: &#x27;en&#x27;,
  fallbackLocale: false,
  user: dummyUser,
  overrideAccess: false,
  showHiddenFields: true,
})
</code></pre>
<h3>Restore</h3>
<pre><code class="language-js">// Result will be the restored global document.
const result = await payload.restoreGlobalVersion({
  slug: &#x27;header&#x27;, // required
  id: &#x27;507f1f77bcf86cd799439013&#x27;, // required
  depth: 2,
  user: dummyUser,
  overrideAccess: false,
  showHiddenFields: true,
})
</code></pre>
<h2>Access Control</h2>
<p>Versions expose a new <a href="../access-control/overview">Access Control</a> function on both <a href="../configuration/collections">Collections</a> and <a href="../configuration/globals">Globals</a> that allow for you to control who can see versions of documents, and who can&#x27;t.</p>
<div class="overflow-x-auto my-8"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr class="even:bg-gray-50"><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Function</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Allows/Denies Access</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><strong><code>readVersions</code></strong></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Used to control who can read versions, and who can&#x27;t. Will automatically restrict the Admin UI version viewing access.</td></tr></tbody></table></div>
<p>For full details on how to use Access Control with Versions, see the <a href="../access-control/overview">Access Control</a> documentation.</p></div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"frontMatter":{"title":"Versions","label":"Overview","order":10,"desc":"Keep a version history or audit log of changes and publish collection documents and globals.","keywords":"version history, revisions, audit log, draft, publish, restore, autosave, Content Management System, cms, headless, javascript, node, react, nextjs"},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    img: \"img\",\n    em: \"em\",\n    strong: \"strong\",\n    ul: \"ul\",\n    li: \"li\",\n    a: \"a\",\n    h2: \"h2\",\n    h3: \"h3\",\n    code: \"code\",\n    table: \"table\",\n    thead: \"thead\",\n    tr: \"tr\",\n    th: \"th\",\n    tbody: \"tbody\",\n    td: \"td\",\n    pre: \"pre\"\n  }, _provideComponents(), props.components), {Banner} = _components;\n  if (!Banner) _missingMdxReference(\"Banner\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(Banner, {\n      children: _jsx(_components.p, {\n        children: \"Payload's powerful Versions functionality allows you to keep a running history\\nof changes over time and extensible to fit any content publishing workflow.\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"When enabled, Payload will automatically scaffold a new Collection in your database to store versions of your document(s) over time, and the Admin UI will be extended with additional views that allow you to browse document versions, view diffs in order to see exactly what has changed in your documents (and when they changed), and restore documents back to prior versions easily.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.img, {\n        src: \"/images/docs/versions.png\",\n        alt: \"Versions\"\n      }), \"\\n\", _jsx(_components.em, {\n        children: \"Comparing an old version to a newer version of a document\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"With Versions, you can:\"\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Maintain an audit log / history of every change ever made to a document, including monitoring for what user made which change\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Restore documents and globals to prior states in case you need to roll back changes\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Build a true \", _jsx(_components.a, {\n          href: \"/docs/versions/drafts\",\n          children: \"Draft Preview\"\n        }), \" mode for your data\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Manage who can see Drafts, and who can only see Published documents via \", _jsx(_components.a, {\n          href: \"/docs/access-control/overview\",\n          children: \"Access Control\"\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Enable \", _jsx(_components.a, {\n          href: \"/docs/versions/autosave\",\n          children: \"Autosave\"\n        }), \" on collections and globals to never lose your work again\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Build a powerful publishing schedule mechanism to create documents and have them become publicly readable automatically at a future date\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(Banner, {\n      type: \"success\",\n      children: _jsx(_components.p, {\n        children: \"Versions are extremely performant and totally opt-in. They don't change the\\nshape of your data at all. All versions are stored in a separate Collection\\nand can be turned on and off easily at your discretion.\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Options\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Versions support a few different levels of functionality that each come with their own impacts to document workflow.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Versions enabled, drafts disabled\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"If you enable versions but keep draft mode disabled, Payload will simply create a new version of a document each time you update a document. This is great for use cases where you need to retain a history of all document updates over time, but always want to treat the newest document version as the version that is \\\"published\\\".\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For example, a use case for \\\"versions enabled, drafts disabled\\\" could be on a collection of users, where you might want to keep a version history (or audit log) of all changes ever made to users - but any changes to users should \", _jsx(_components.em, {\n        children: \"always\"\n      }), \" be treated as \\\"published\\\" and you have no need to maintain a \\\"draft\\\" version of a user.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Versions and drafts enabled\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you have versions \", _jsx(_components.em, {\n        children: \"and\"\n      }), \" drafts enabled, you are able to control which documents are published, and which are considered draft. That lets you write \", _jsx(_components.a, {\n        href: \"../access-control/overview\",\n        children: \"Access Control\"\n      }), \" to control who can see published documents, and who can see draft documents. It also lets you save versions (drafts) that are \", _jsx(_components.em, {\n        children: \"newer\"\n      }), \" than your most recently published document, which is helpful if you want to draft changes and maybe even preview them before you publish the changes. Read more about Drafts \", _jsx(_components.a, {\n        href: \"/docs/versions/drafts\",\n        children: \"here\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Versions, drafts, and autosave enabled\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"When you have versions, drafts, \", _jsx(_components.em, {\n        children: \"and\"\n      }), \" \", _jsx(_components.code, {\n        children: \"autosave\"\n      }), \" enabled, the Admin UI will automatically save changes that you make to a new \", _jsx(_components.code, {\n        children: \"draft\"\n      }), \" version as you edit a document, which makes sure that you never lose your changes ever again. Autosave will not affect your published post at all—instead, it'll just save your changes and let you publish them whenever you or your editors are ready to do so. Read more about Autosave \", _jsx(_components.a, {\n        href: \"/docs/versions/autosave\",\n        children: \"here\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Collection config\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Configuring Versions is done by adding the \", _jsx(_components.code, {\n        children: \"versions\"\n      }), \" key to your Collection configs. Set it to \", _jsx(_components.code, {\n        children: \"true\"\n      }), \" to enable default Versions settings, or customize versions options by setting the property equal to an object containing the following available options:\"]\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Option\"\n          }), _jsx(_components.th, {\n            children: \"Description\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"maxPerDoc\"\n            })\n          }), _jsx(_components.td, {\n            children: \"Use this setting to control how many versions to keep on a document by document basis. Must be an integer. Defaults to 100, use 0 to save all versions.\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"drafts\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"Enable \", _jsx(_components.a, {\n              href: \"/docs/versions/drafts\",\n              children: \"Drafts\"\n            }), \" mode for this collection. To enable, set to \", _jsx(_components.code, {\n              children: \"true\"\n            }), \" or pass an object with \", _jsx(_components.code, {\n              children: \"draft\"\n            }), \" \", _jsx(_components.a, {\n              href: \"/docs/versions/drafts#options\",\n              children: \"options\"\n            }), \".\"]\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Global config\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Global versions work similarly to Collection versions but have a slightly different set of config properties supported.\"\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Option\"\n          }), _jsx(_components.th, {\n            children: \"Description\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"max\"\n            })\n          }), _jsx(_components.td, {\n            children: \"Use this setting to control how many versions to keep on a global by global basis. Must be an integer.\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"drafts\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"Enable \", _jsx(_components.a, {\n              href: \"/docs/versions/drafts\",\n              children: \"Drafts\"\n            }), \" mode for this global. To enable, set to \", _jsx(_components.code, {\n              children: \"true\"\n            }), \" or pass an object with \", _jsx(_components.code, {\n              children: \"draft\"\n            }), \" \", _jsx(_components.a, {\n              href: \"/docs/versions/drafts#options\",\n              children: \"options\"\n            })]\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Database impact\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"By enabling \", _jsx(_components.code, {\n        children: \"versions\"\n      }), \", a new database collection will be made to store versions for your collection or global. The collection will be named based off the \", _jsx(_components.code, {\n        children: \"slug\"\n      }), \" of the collection or global and will follow this pattern (where \", _jsx(_components.code, {\n        children: \"slug\"\n      }), \" is replaced with the \", _jsx(_components.code, {\n        children: \"slug\"\n      }), \" of your collection or global):\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"_slug_versions\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Each document in this new \", _jsx(_components.code, {\n        children: \"versions\"\n      }), \" collection will store a set of meta properties about the version as well as a \", _jsx(_components.em, {\n        children: \"full\"\n      }), \" copy of the document. For example, a version's data might look like this for a Collection document:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-json\",\n        children: \"{\\n  \\\"_id\\\": \\\"61cf752c19cdf1b1af7b61f1\\\", // a unique ID of this version\\n  \\\"parent\\\": \\\"61ce1354091d5b3ffc20ea6e\\\", // the ID of the parent document\\n  \\\"autosave\\\": false, // used to denote if this version was created via autosave\\n  \\\"version\\\": {\\n    // your document's data goes here\\n    // all fields are set to not required and this property can be partially complete\\n  },\\n  \\\"createdAt\\\": \\\"2021-12-31T21:25:00.992+00:00\\\",\\n  \\\"updatedAt\\\": \\\"2021-12-31T21:25:00.992+00:00\\\"\\n}\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Global versions are stored the same as the collection version shown above, except they do not feature the \", _jsx(_components.code, {\n        children: \"parent\"\n      }), \" property, as each Global receives its own \", _jsx(_components.code, {\n        children: \"versions\"\n      }), \" collection. That means we know that all versions in that collection correspond to that specific global.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Version operations\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Versions expose new operations for both collections and globals. They allow you to find and query versions, find a single version by ID, and publish (or restore) a version by ID. Both Collections and Globals support the same new operations. They are used primarily by the admin UI, but if you are writing custom logic in your app and would like to utilize them, they're available for you to use as well via REST, GraphQL, and Local APIs.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Collection REST endpoints:\"\n      })\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Method\"\n          }), _jsx(_components.th, {\n            children: \"Path\"\n          }), _jsx(_components.th, {\n            children: \"Description\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"GET\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"/api/{collectionSlug}/versions\"\n            })\n          }), _jsx(_components.td, {\n            children: \"Find and query paginated versions\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"GET\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"/api/{collectionSlug}/versions/:id\"\n            })\n          }), _jsx(_components.td, {\n            children: \"Find a specific version by ID\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"POST\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"/api/{collectionSlug}/versions/:id\"\n            })\n          }), _jsx(_components.td, {\n            children: \"Restore a version by ID\"\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Collection GraphQL queries:\"\n      })\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Query Name\"\n          }), _jsx(_components.th, {\n            children: \"Operation\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.strong, {\n              children: _jsx(_components.code, {\n                children: \"version{collection.label.singular}\"\n              })\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"findVersionByID\"\n            })\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.strong, {\n              children: _jsx(_components.code, {\n                children: \"versions{collection.label.plural}\"\n              })\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"findVersions\"\n            })\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"And mutation:\"\n      })\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Query Name\"\n          }), _jsx(_components.th, {\n            children: \"Operation\"\n          })]\n        })\n      }), _jsx(_components.tbody, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.strong, {\n              children: _jsx(_components.code, {\n                children: \"restoreVersion{collection.label.singular}\"\n              })\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"restoreVersion\"\n            })\n          })]\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Collection Local API methods:\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Find\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"// Result will be a paginated set of Versions.\\n// See /docs/queries/pagination for more.\\nconst result = await payload.findVersions({\\n  collection: 'posts', // required\\n  depth: 2,\\n  page: 1,\\n  limit: 10,\\n  where: {}, // pass a `where` query here\\n  sort: '-createdAt',\\n  locale: 'en',\\n  fallbackLocale: false,\\n  user: dummyUser,\\n  overrideAccess: false,\\n  showHiddenFields: true,\\n})\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Find by ID\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"// Result will be a Post document.\\nconst result = await payload.findVersionByID({\\n  collection: 'posts', // required\\n  id: '507f1f77bcf86cd799439013', // required\\n  depth: 2,\\n  locale: 'en',\\n  fallbackLocale: false,\\n  user: dummyUser,\\n  overrideAccess: false,\\n  showHiddenFields: true,\\n})\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Restore\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"// Result will be the restored global document.\\nconst result = await payload.restoreVersion({\\n  collection: 'posts', // required\\n  id: '507f1f77bcf86cd799439013', // required\\n  depth: 2,\\n  user: dummyUser,\\n  overrideAccess: false,\\n  showHiddenFields: true,\\n})\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Global REST endpoints:\"\n      })\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Method\"\n          }), _jsx(_components.th, {\n            children: \"Path\"\n          }), _jsx(_components.th, {\n            children: \"Description\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"GET\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"/api/globals/{globalSlug}/versions\"\n            })\n          }), _jsx(_components.td, {\n            children: \"Find and query paginated versions\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"GET\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"/api/globals/{globalSlug}/versions/:id\"\n            })\n          }), _jsx(_components.td, {\n            children: \"Find a specific version by ID\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"POST\"\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"/api/globals/{globalSlug}/versions/:id\"\n            })\n          }), _jsx(_components.td, {\n            children: \"Restore a version by ID\"\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Global GraphQL queries:\"\n      })\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Query Name\"\n          }), _jsx(_components.th, {\n            children: \"Operation\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.strong, {\n              children: _jsx(_components.code, {\n                children: \"version{global.label}\"\n              })\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"findVersionByID\"\n            })\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.strong, {\n              children: _jsx(_components.code, {\n                children: \"versions{global.label}\"\n              })\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"findVersions\"\n            })\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Global GraphQL mutation:\"\n      })\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Query Name\"\n          }), _jsx(_components.th, {\n            children: \"Operation\"\n          })]\n        })\n      }), _jsx(_components.tbody, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.strong, {\n              children: _jsx(_components.code, {\n                children: \"restoreVersion{global.label}\"\n              })\n            })\n          }), _jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"restoreVersion\"\n            })\n          })]\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Global Local API methods:\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Find\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"// Result will be a paginated set of Versions.\\n// See /docs/queries/pagination for more.\\nconst result = await payload.findGlobalVersions({\\n  slug: 'header', // required\\n  depth: 2,\\n  page: 1,\\n  limit: 10,\\n  where: {}, // pass a `where` query here\\n  sort: '-createdAt',\\n  locale: 'en',\\n  fallbackLocale: false,\\n  user: dummyUser,\\n  overrideAccess: false,\\n  showHiddenFields: true,\\n})\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Find by ID\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"// Result will be a Post document.\\nconst result = await payload.findGlobalVersionByID({\\n  slug: 'header', // required\\n  id: '507f1f77bcf86cd799439013', // required\\n  depth: 2,\\n  locale: 'en',\\n  fallbackLocale: false,\\n  user: dummyUser,\\n  overrideAccess: false,\\n  showHiddenFields: true,\\n})\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Restore\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-js\",\n        children: \"// Result will be the restored global document.\\nconst result = await payload.restoreGlobalVersion({\\n  slug: 'header', // required\\n  id: '507f1f77bcf86cd799439013', // required\\n  depth: 2,\\n  user: dummyUser,\\n  overrideAccess: false,\\n  showHiddenFields: true,\\n})\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Access Control\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Versions expose a new \", _jsx(_components.a, {\n        href: \"../access-control/overview\",\n        children: \"Access Control\"\n      }), \" function on both \", _jsx(_components.a, {\n        href: \"../configuration/collections\",\n        children: \"Collections\"\n      }), \" and \", _jsx(_components.a, {\n        href: \"../configuration/globals\",\n        children: \"Globals\"\n      }), \" that allow for you to control who can see versions of documents, and who can't.\"]\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Function\"\n          }), _jsx(_components.th, {\n            children: \"Allows/Denies Access\"\n          })]\n        })\n      }), _jsx(_components.tbody, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.strong, {\n              children: _jsx(_components.code, {\n                children: \"readVersions\"\n              })\n            })\n          }), _jsx(_components.td, {\n            children: \"Used to control who can read versions, and who can't. Will automatically restrict the Admin UI version viewing access.\"\n          })]\n        })\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For full details on how to use Access Control with Versions, see the \", _jsx(_components.a, {\n        href: \"../access-control/overview\",\n        children: \"Access Control\"\n      }), \" documentation.\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/docs/[...slug]","query":{"slug":["versions","overview"]},"buildId":"pbayt_BRhSN28J-gcoKlf","assetPrefix":"/payload-just-docs","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>