<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/payload-just-docs/_next/static/css/adeeaed65336a824.css" as="style" crossorigin=""/><link rel="stylesheet" href="/payload-just-docs/_next/static/css/adeeaed65336a824.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/payload-just-docs/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/payload-just-docs/_next/static/chunks/webpack-c335844537ee4527.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/framework-fae63b21a27d6472.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/main-4b5290d5009800e1.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/pages/_app-2747846ed27f1501.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/chunks/pages/docs/%5B...slug%5D-e023289636109d90.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/pbayt_BRhSN28J-gcoKlf/_buildManifest.js" defer="" crossorigin=""></script><script src="/payload-just-docs/_next/static/pbayt_BRhSN28J-gcoKlf/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><div class="container mx-auto px-4 py-8 max-w-4xl"><h1 class="text-4xl font-bold mb-4">Autosave</h1><p class="text-xl text-gray-600 mb-8">Using Payload&#x27;s Draft functionality, you can configure your collections and globals to autosave changes as drafts, and publish only you&#x27;re ready.</p><div class="prose prose-lg max-w-none"><p>Extending on Payload&#x27;s <a href="/docs/versions/drafts">Draft</a> functionality, you can configure your collections and globals to autosave changes as drafts, and publish only you&#x27;re ready. The Admin UI will automatically adapt to autosaving progress at an interval that you define, and will store all autosaved changes as a new Draft version. Never lose your work - and publish changes to the live document only when you&#x27;re ready.</p>
<div class="p-4 my-4 rounded-lg border bg-yellow-50 border-yellow-200 text-yellow-800"><svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg><p>Autosave relies on Versions and Drafts being enabled in order to function.</p></div>
<p><img src="/images/docs/autosave-enabled.png" alt="Autosave Enabled"/>
<em>If Autosave is enabled, drafts will be created automatically as the document is modified and the Admin UI adds an indicator describing when the document was last saved to the top right of the sidebar.</em></p>
<h2>Options</h2>
<p>Collections and Globals both support the same options for configuring autosave. You can either set <code>versions.drafts.autosave</code> to <code>true</code>, or pass an object to configure autosave properties.</p>
<div class="overflow-x-auto my-8"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr class="even:bg-gray-50"><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Drafts Autosave Options</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><code>interval</code></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Define an <code>interval</code> in milliseconds to automatically save progress while documents are edited. Document updates are &quot;debounced&quot; at this interval. Defaults to <code>800</code>.</td></tr></tbody></table></div>
<p><strong>Example config with versions, drafts, and autosave enabled:</strong></p>
<pre><code class="language-ts">import type { CollectionConfig } from &#x27;payload&#x27;

export const Pages: CollectionConfig = {
  slug: &#x27;pages&#x27;,
  access: {
    read: ({ req }) =&gt; {
      // If there is a user logged in,
      // let them retrieve all documents
      if (req.user) return true

      // If there is no user,
      // restrict the documents that are returned
      // to only those where `_status` is equal to `published`
      return {
        _status: {
          equals: &#x27;published&#x27;,
        },
      }
    },
  },
  versions: {
    drafts: {
      autosave: true,

      // Alternatively, you can specify an `interval`:
      // autosave: {
      //   interval: 1500,
      // },
    },
  },
  //.. the rest of the Pages config here
}
</code></pre>
<h2>Autosave API</h2>
<p>When <code>autosave</code> is enabled, all <code>update</code> operations within Payload expose a new argument called <code>autosave</code>. When set to <code>true</code>, Payload will treat the incoming draft update as an <code>autosave</code>. This is primarily used by the Admin UI, but there may be some cases where you are building an app for your users and wish to implement <code>autosave</code> in your own app. To do so, use the <code>autosave</code> argument in your <code>update</code> operations.</p>
<h3>How autosaves are stored</h3>
<p>If we created a new version for each autosave, you&#x27;d quickly find a ton of autosaves that clutter up your <code>_versions</code> collection within the database. That would be messy quick because <code>autosave</code> is typically set to save a document at ~800ms intervals.</p>
<div class="p-4 my-4 rounded-lg border bg-green-50 border-green-200 text-green-800"><svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg><p>Instead of creating a new version each time a document is autosaved, Payload
smartly only creates <strong>one</strong> autosave version, and then updates that specific
version with each autosave performed. This makes sure that your versions
remain nice and tidy.</p></div></div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"frontMatter":{"title":"Autosave","label":"Autosave","order":30,"desc":"Using Payload's Draft functionality, you can configure your collections and globals to autosave changes as drafts, and publish only you're ready.","keywords":"version history, revisions, audit log, draft, publish, autosave, Content Management System, cms, headless, javascript, node, react, nextjss"},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    img: \"img\",\n    em: \"em\",\n    h2: \"h2\",\n    code: \"code\",\n    table: \"table\",\n    thead: \"thead\",\n    tr: \"tr\",\n    th: \"th\",\n    tbody: \"tbody\",\n    td: \"td\",\n    strong: \"strong\",\n    pre: \"pre\",\n    h3: \"h3\"\n  }, _provideComponents(), props.components), {Banner} = _components;\n  if (!Banner) _missingMdxReference(\"Banner\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"Extending on Payload's \", _jsx(_components.a, {\n        href: \"/docs/versions/drafts\",\n        children: \"Draft\"\n      }), \" functionality, you can configure your collections and globals to autosave changes as drafts, and publish only you're ready. The Admin UI will automatically adapt to autosaving progress at an interval that you define, and will store all autosaved changes as a new Draft version. Never lose your work - and publish changes to the live document only when you're ready.\"]\n    }), \"\\n\", _jsx(Banner, {\n      type: \"warning\",\n      children: _jsx(_components.p, {\n        children: \"Autosave relies on Versions and Drafts being enabled in order to function.\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.img, {\n        src: \"/images/docs/autosave-enabled.png\",\n        alt: \"Autosave Enabled\"\n      }), \"\\n\", _jsx(_components.em, {\n        children: \"If Autosave is enabled, drafts will be created automatically as the document is modified and the Admin UI adds an indicator describing when the document was last saved to the top right of the sidebar.\"\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Options\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Collections and Globals both support the same options for configuring autosave. You can either set \", _jsx(_components.code, {\n        children: \"versions.drafts.autosave\"\n      }), \" to \", _jsx(_components.code, {\n        children: \"true\"\n      }), \", or pass an object to configure autosave properties.\"]\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Drafts Autosave Options\"\n          }), _jsx(_components.th, {\n            children: \"Description\"\n          })]\n        })\n      }), _jsx(_components.tbody, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"interval\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"Define an \", _jsx(_components.code, {\n              children: \"interval\"\n            }), \" in milliseconds to automatically save progress while documents are edited. Document updates are \\\"debounced\\\" at this interval. Defaults to \", _jsx(_components.code, {\n              children: \"800\"\n            }), \".\"]\n          })]\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Example config with versions, drafts, and autosave enabled:\"\n      })\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"import type { CollectionConfig } from 'payload'\\n\\nexport const Pages: CollectionConfig = {\\n  slug: 'pages',\\n  access: {\\n    read: ({ req }) =\u003e {\\n      // If there is a user logged in,\\n      // let them retrieve all documents\\n      if (req.user) return true\\n\\n      // If there is no user,\\n      // restrict the documents that are returned\\n      // to only those where `_status` is equal to `published`\\n      return {\\n        _status: {\\n          equals: 'published',\\n        },\\n      }\\n    },\\n  },\\n  versions: {\\n    drafts: {\\n      autosave: true,\\n\\n      // Alternatively, you can specify an `interval`:\\n      // autosave: {\\n      //   interval: 1500,\\n      // },\\n    },\\n  },\\n  //.. the rest of the Pages config here\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Autosave API\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"When \", _jsx(_components.code, {\n        children: \"autosave\"\n      }), \" is enabled, all \", _jsx(_components.code, {\n        children: \"update\"\n      }), \" operations within Payload expose a new argument called \", _jsx(_components.code, {\n        children: \"autosave\"\n      }), \". When set to \", _jsx(_components.code, {\n        children: \"true\"\n      }), \", Payload will treat the incoming draft update as an \", _jsx(_components.code, {\n        children: \"autosave\"\n      }), \". This is primarily used by the Admin UI, but there may be some cases where you are building an app for your users and wish to implement \", _jsx(_components.code, {\n        children: \"autosave\"\n      }), \" in your own app. To do so, use the \", _jsx(_components.code, {\n        children: \"autosave\"\n      }), \" argument in your \", _jsx(_components.code, {\n        children: \"update\"\n      }), \" operations.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"How autosaves are stored\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If we created a new version for each autosave, you'd quickly find a ton of autosaves that clutter up your \", _jsx(_components.code, {\n        children: \"_versions\"\n      }), \" collection within the database. That would be messy quick because \", _jsx(_components.code, {\n        children: \"autosave\"\n      }), \" is typically set to save a document at ~800ms intervals.\"]\n    }), \"\\n\", _jsx(Banner, {\n      type: \"success\",\n      children: _jsxs(_components.p, {\n        children: [\"Instead of creating a new version each time a document is autosaved, Payload\\nsmartly only creates \", _jsx(_components.strong, {\n          children: \"one\"\n        }), \" autosave version, and then updates that specific\\nversion with each autosave performed. This makes sure that your versions\\nremain nice and tidy.\"]\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/docs/[...slug]","query":{"slug":["versions","autosave"]},"buildId":"pbayt_BRhSN28J-gcoKlf","assetPrefix":"/payload-just-docs","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>