<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/adeeaed65336a824.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/adeeaed65336a824.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-fd8027ecb5121007.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-fae63b21a27d6472.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-04104d75f6814829.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-2747846ed27f1501.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/docs/%5B...slug%5D-e023289636109d90.js" defer="" crossorigin=""></script><script src="/_next/static/rEpVRygLyV6yJ0i_Ohw0C/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/rEpVRygLyV6yJ0i_Ohw0C/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><div class="container mx-auto px-4 py-8 max-w-4xl"><h1 class="text-4xl font-bold mb-4">Document Locking</h1><p class="text-xl text-gray-600 mb-8">Ensure your documents are locked during editing to prevent concurrent changes from multiple users and maintain data integrity.</p><div class="prose prose-lg max-w-none"><p>Document locking in Payload ensures that only one user at a time can edit a document, preventing data conflicts and accidental overwrites. When a document is locked, other users are prevented from making changes until the lock is released, ensuring data integrity in collaborative environments.</p>
<p>The lock is automatically triggered when a user begins editing a document within the Admin Panel and remains in place until the user exits the editing view or the lock expires due to inactivity.</p>
<h2>How it works</h2>
<p>When a user starts editing a document, Payload locks it for that user. If another user attempts to access the same document, they will be notified that it is currently being edited. They can then choose one of the following options:</p>
<ul>
<li>View in Read-Only: View the document without the ability to make any changes.</li>
<li>Take Over: Take over editing from the current user, which locks the document for the new editor and notifies the original user.</li>
<li>Return to Dashboard: Navigate away from the locked document and continue with other tasks.</li>
</ul>
<p>The lock will automatically expire after a set period of inactivity, configurable using the <code>duration</code> property in the <code>lockDocuments</code> configuration, after which others can resume editing.</p>
<div class="p-4 my-4 rounded-lg border bg-blue-50 border-blue-200 text-blue-800"><svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><p><strong>Note:</strong> If your application does not require document locking, you can
disable this feature for any collection or global by setting the
<code>lockDocuments</code> property to <code>false</code>.</p></div>
<h3>Config Options</h3>
<p>The <code>lockDocuments</code> property exists on both the Collection Config and the Global Config. Document locking is enabled by default, but you can customize the lock duration or turn off the feature for any collection or global.</p>
<p>Here&#x27;s an example configuration for document locking:</p>
<pre><code class="language-ts">import type { CollectionConfig } from &#x27;payload&#x27;

export const Posts: CollectionConfig = {
  slug: &#x27;posts&#x27;,
  fields: [
    {
      name: &#x27;title&#x27;,
      type: &#x27;text&#x27;,
    },
    // other fields...
  ],
  lockDocuments: {
    duration: 600, // Duration in seconds
  },
}
</code></pre>
<h4>Locking Options</h4>
<div class="overflow-x-auto my-8"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr class="even:bg-gray-50"><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Option</th><th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><strong><code>lockDocuments</code></strong></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Enables or disables document locking for the collection or global. By default, document locking is enabled. Set to an object to configure, or set to false to disable locking.</td></tr><tr class="even:bg-gray-50"><td class="px-6 py-4 whitespace-normal text-sm text-gray-500"><strong><code>duration</code></strong></td><td class="px-6 py-4 whitespace-normal text-sm text-gray-500">Specifies the duration (in seconds) for how long a document remains locked without user interaction. The default is 300 seconds (5 minutes).</td></tr></tbody></table></div>
<h3>Impact on APIs</h3>
<p>Document locking affects both the Local and REST APIs, ensuring that if a document is locked, concurrent users will not be able to perform updates or deletes on that document (including globals). If a user attempts to update or delete a locked document, they will receive an error.</p>
<p>Once the document is unlocked or the lock duration has expired, other users can proceed with updates or deletes as normal.</p>
<h4>Overriding Locks</h4>
<p>For operations like <code>update</code> and <code>delete</code>, Payload includes an <code>overrideLock</code> option. This boolean flag, when set to <code>false</code>, enforces document locks, ensuring that the operation will not proceed if another user currently holds the lock.</p>
<p>By default, <code>overrideLock</code> is set to <code>true</code>, which means that document locks are ignored, and the operation will proceed even if the document is locked. To enforce locks and prevent updates or deletes on locked documents, set <code>overrideLock: false</code>.</p>
<pre><code class="language-ts">const result = await payload.update({
  collection: &#x27;posts&#x27;,
  id: &#x27;123&#x27;,
  data: {
    title: &#x27;New title&#x27;,
  },
  overrideLock: false, // Enforces the document lock, preventing updates if the document is locked
})
</code></pre>
<p>This option is particularly useful in scenarios where administrative privileges or specific workflows require you to override the lock and ensure the operation is completed.</p></div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"frontMatter":{"title":"Document Locking","label":"Document Locking","order":40,"desc":"Ensure your documents are locked during editing to prevent concurrent changes from multiple users and maintain data integrity.","keywords":"locking, document locking, edit locking, document, concurrency, Payload, headless, Content Management System, cms, javascript, react, node, nextjs"},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h2: \"h2\",\n    ul: \"ul\",\n    li: \"li\",\n    code: \"code\",\n    strong: \"strong\",\n    h3: \"h3\",\n    pre: \"pre\",\n    h4: \"h4\",\n    table: \"table\",\n    thead: \"thead\",\n    tr: \"tr\",\n    th: \"th\",\n    tbody: \"tbody\",\n    td: \"td\"\n  }, _provideComponents(), props.components), {Banner} = _components;\n  if (!Banner) _missingMdxReference(\"Banner\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"Document locking in Payload ensures that only one user at a time can edit a document, preventing data conflicts and accidental overwrites. When a document is locked, other users are prevented from making changes until the lock is released, ensuring data integrity in collaborative environments.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The lock is automatically triggered when a user begins editing a document within the Admin Panel and remains in place until the user exits the editing view or the lock expires due to inactivity.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"How it works\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"When a user starts editing a document, Payload locks it for that user. If another user attempts to access the same document, they will be notified that it is currently being edited. They can then choose one of the following options:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"View in Read-Only: View the document without the ability to make any changes.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Take Over: Take over editing from the current user, which locks the document for the new editor and notifies the original user.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Return to Dashboard: Navigate away from the locked document and continue with other tasks.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The lock will automatically expire after a set period of inactivity, configurable using the \", _jsx(_components.code, {\n        children: \"duration\"\n      }), \" property in the \", _jsx(_components.code, {\n        children: \"lockDocuments\"\n      }), \" configuration, after which others can resume editing.\"]\n    }), \"\\n\", _jsx(Banner, {\n      type: \"info\",\n      children: _jsxs(_components.p, {\n        children: [_jsx(_components.strong, {\n          children: \"Note:\"\n        }), \" If your application does not require document locking, you can\\ndisable this feature for any collection or global by setting the\\n\", _jsx(_components.code, {\n          children: \"lockDocuments\"\n        }), \" property to \", _jsx(_components.code, {\n          children: \"false\"\n        }), \".\"]\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Config Options\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The \", _jsx(_components.code, {\n        children: \"lockDocuments\"\n      }), \" property exists on both the Collection Config and the Global Config. Document locking is enabled by default, but you can customize the lock duration or turn off the feature for any collection or global.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Here's an example configuration for document locking:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"import type { CollectionConfig } from 'payload'\\n\\nexport const Posts: CollectionConfig = {\\n  slug: 'posts',\\n  fields: [\\n    {\\n      name: 'title',\\n      type: 'text',\\n    },\\n    // other fields...\\n  ],\\n  lockDocuments: {\\n    duration: 600, // Duration in seconds\\n  },\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h4, {\n      children: \"Locking Options\"\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Option\"\n          }), _jsx(_components.th, {\n            children: \"Description\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.strong, {\n              children: _jsx(_components.code, {\n                children: \"lockDocuments\"\n              })\n            })\n          }), _jsx(_components.td, {\n            children: \"Enables or disables document locking for the collection or global. By default, document locking is enabled. Set to an object to configure, or set to false to disable locking.\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.strong, {\n              children: _jsx(_components.code, {\n                children: \"duration\"\n              })\n            })\n          }), _jsx(_components.td, {\n            children: \"Specifies the duration (in seconds) for how long a document remains locked without user interaction. The default is 300 seconds (5 minutes).\"\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Impact on APIs\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Document locking affects both the Local and REST APIs, ensuring that if a document is locked, concurrent users will not be able to perform updates or deletes on that document (including globals). If a user attempts to update or delete a locked document, they will receive an error.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Once the document is unlocked or the lock duration has expired, other users can proceed with updates or deletes as normal.\"\n    }), \"\\n\", _jsx(_components.h4, {\n      children: \"Overriding Locks\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For operations like \", _jsx(_components.code, {\n        children: \"update\"\n      }), \" and \", _jsx(_components.code, {\n        children: \"delete\"\n      }), \", Payload includes an \", _jsx(_components.code, {\n        children: \"overrideLock\"\n      }), \" option. This boolean flag, when set to \", _jsx(_components.code, {\n        children: \"false\"\n      }), \", enforces document locks, ensuring that the operation will not proceed if another user currently holds the lock.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"By default, \", _jsx(_components.code, {\n        children: \"overrideLock\"\n      }), \" is set to \", _jsx(_components.code, {\n        children: \"true\"\n      }), \", which means that document locks are ignored, and the operation will proceed even if the document is locked. To enforce locks and prevent updates or deletes on locked documents, set \", _jsx(_components.code, {\n        children: \"overrideLock: false\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-ts\",\n        children: \"const result = await payload.update({\\n  collection: 'posts',\\n  id: '123',\\n  data: {\\n    title: 'New title',\\n  },\\n  overrideLock: false, // Enforces the document lock, preventing updates if the document is locked\\n})\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This option is particularly useful in scenarios where administrative privileges or specific workflows require you to override the lock and ensure the operation is completed.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/docs/[...slug]","query":{"slug":["admin","locked-documents"]},"buildId":"rEpVRygLyV6yJ0i_Ohw0C","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>