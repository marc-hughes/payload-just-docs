{"pageProps":{"frontMatter":{"title":"Managing User Preferences","label":"Preferences","order":60,"desc":"Store the preferences of your users as they interact with the Admin Panel.","keywords":"admin, preferences, custom, customize, documentation, Content Management System, cms, headless, javascript, node, react, nextjs"},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    ol: \"ol\",\n    li: \"li\",\n    code: \"code\",\n    strong: \"strong\",\n    h2: \"h2\",\n    ul: \"ul\",\n    table: \"table\",\n    thead: \"thead\",\n    tr: \"tr\",\n    th: \"th\",\n    tbody: \"tbody\",\n    td: \"td\",\n    h4: \"h4\",\n    pre: \"pre\"\n  }, _provideComponents(), props.components), {Banner} = _components;\n  if (!Banner) _missingMdxReference(\"Banner\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"As your users interact with the \", _jsx(_components.a, {\n        href: \"./overview\",\n        children: \"Admin Panel\"\n      }), \", you might want to store their preferences in a persistent manner, so that when they revisit the Admin Panel in a different session or from a different device, they can pick right back up where they left off.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Out of the box, Payload handles the persistence of your users' preferences in a handful of ways, including:\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Columns in the Collection List View: their active state and order\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"The user's last active \", _jsx(_components.a, {\n          href: \"../configuration/localization\",\n          children: \"Locale\"\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"The \\\"collapsed\\\" state of \", _jsx(_components.code, {\n          children: \"blocks\"\n        }), \", \", _jsx(_components.code, {\n          children: \"array\"\n        }), \", and \", _jsx(_components.code, {\n          children: \"collapsible\"\n        }), \" fields\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"The last-known state of the \", _jsx(_components.code, {\n          children: \"Nav\"\n        }), \" component, etc.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(Banner, {\n      type: \"warning\",\n      children: [_jsx(_components.p, {\n        children: _jsx(_components.strong, {\n          children: \"Important:\"\n        })\n      }), _jsx(_components.p, {\n        children: \"All preferences are stored on an individual user basis. Payload automatically recognizes the user\\nthat is reading or setting a preference via all provided authentication methods.\"\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Use Cases\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This API is used significantly for internal operations of the Admin Panel, as mentioned above. But, if you're building your own React components for use in the Admin Panel, you can allow users to set their own preferences in correspondence to their usage of your components. For example:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"If you have built a \\\"color picker\\\", you could \\\"remember\\\" the last used colors that the user has set for easy access next time\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"If you've built a custom \", _jsx(_components.code, {\n          children: \"Nav\"\n        }), \" component, and you've built in an \\\"accordion-style\\\" UI, you might want to store the \", _jsx(_components.code, {\n          children: \"collapsed\"\n        }), \" state of each Nav collapsible item. This way, if an editor returns to the panel, their \", _jsx(_components.code, {\n          children: \"Nav\"\n        }), \" state is persisted automatically\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"You might want to store \", _jsx(_components.code, {\n          children: \"recentlyAccessed\"\n        }), \" documents to give admin editors an easy shortcut back to their recently accessed documents on the \", _jsx(_components.code, {\n          children: \"Dashboard\"\n        }), \" or similar\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Many other use cases exist. Invent your own! Give your editors an intelligent and persistent editing experience.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Database\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Payload automatically creates an internally used \", _jsx(_components.code, {\n        children: \"payload-preferences\"\n      }), \" Collection that stores user preferences. Each document in the \", _jsx(_components.code, {\n        children: \"payload-preferences\"\n      }), \" Collection contains the following shape:\"]\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Key\"\n          }), _jsx(_components.th, {\n            children: \"Value\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"id\"\n            })\n          }), _jsx(_components.td, {\n            children: \"A unique ID for each preference stored.\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"key\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"A unique \", _jsx(_components.code, {\n              children: \"key\"\n            }), \" that corresponds to the preference.\"]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"user.value\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"The ID of the \", _jsx(_components.code, {\n              children: \"user\"\n            }), \" that is storing its preference.\"]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"user.relationTo\"\n            })\n          }), _jsxs(_components.td, {\n            children: [\"The \", _jsx(_components.code, {\n              children: \"slug\"\n            }), \" of the Collection that the \", _jsx(_components.code, {\n              children: \"user\"\n            }), \" is logged in as.\"]\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"value\"\n            })\n          }), _jsx(_components.td, {\n            children: \"The value of the preference. Can be any data shape that you need.\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"createdAt\"\n            })\n          }), _jsx(_components.td, {\n            children: \"A timestamp of when the preference was created.\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: _jsx(_components.code, {\n              children: \"updatedAt\"\n            })\n          }), _jsx(_components.td, {\n            children: \"A timestamp set to the last time the preference was updated.\"\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"APIs\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Preferences are available to both \", _jsx(_components.a, {\n        href: \"/docs/graphql/overview#preferences\",\n        children: \"GraphQL\"\n      }), \" and \", _jsx(_components.a, {\n        href: \"/docs/rest-api/overview#preferences\",\n        children: \"REST\"\n      }), \" APIs.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Adding or reading Preferences in your own components\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The Payload Admin Panel offers a \", _jsx(_components.code, {\n        children: \"usePreferences\"\n      }), \" hook. The hook is only meant for use within the Admin Panel itself. It provides you with two methods:\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      children: _jsx(_components.code, {\n        children: \"getPreference\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This async method provides an easy way to retrieve a user's preferences by \", _jsx(_components.code, {\n        children: \"key\"\n      }), \". It will return a promise containing the resulting preference value.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Arguments\"\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"key\"\n        }), \": the \", _jsx(_components.code, {\n          children: \"key\"\n        }), \" of your preference to retrieve.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      children: _jsx(_components.code, {\n        children: \"setPreference\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Also async, this method provides you with an easy way to set a user preference. It returns \", _jsx(_components.code, {\n        children: \"void\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"Arguments:\"\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"key\"\n        }), \": the \", _jsx(_components.code, {\n          children: \"key\"\n        }), \" of your preference to set.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"value\"\n        }), \": the \", _jsx(_components.code, {\n          children: \"value\"\n        }), \" of your preference that you're looking to set.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Example\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Here is an example for how you can utilize \", _jsx(_components.code, {\n        children: \"usePreferences\"\n      }), \" within your custom Admin Panel components. Note - this example is not fully useful and is more just a reference for how to utilize the Preferences API. In this case, we are demonstrating how to set and retrieve a user's last used colors history within a \", _jsx(_components.code, {\n        children: \"ColorPicker\"\n      }), \" or similar type component.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-tsx\",\n        children: \"'use client'\\nimport React, { Fragment, useState, useEffect, useCallback } from 'react'\\nimport { usePreferences } from '@payloadcms/ui'\\n\\nconst lastUsedColorsPreferenceKey = 'last-used-colors'\\n\\nexport function CustomComponent() {\\n  const { getPreference, setPreference } = usePreferences()\\n\\n  // Store the last used colors in local state\\n  const [lastUsedColors, setLastUsedColors] = useState([])\\n\\n  // Callback to add a color to the last used colors\\n  const updateLastUsedColors = useCallback(\\n    (color) => {\\n      // First, check if color already exists in last used colors.\\n      // If it already exists, there is no need to update preferences\\n      const colorAlreadyExists = lastUsedColors.indexOf(color) > -1\\n\\n      if (!colorAlreadyExists) {\\n        const newLastUsedColors = [...lastUsedColors, color]\\n\\n        setLastUsedColors(newLastUsedColors)\\n        setPreference(lastUsedColorsPreferenceKey, newLastUsedColors)\\n      }\\n    },\\n    [lastUsedColors, setPreference],\\n  )\\n\\n  // Retrieve preferences on component mount\\n  // This will only be run one time, because the `getPreference` method never changes\\n  useEffect(() => {\\n    const asyncGetPreference = async () => {\\n      const lastUsedColorsFromPreferences = await getPreference(\\n        lastUsedColorsPreferenceKey,\\n      )\\n      setLastUsedColors(lastUsedColorsFromPreferences)\\n    }\\n\\n    asyncGetPreference()\\n  }, [getPreference])\\n\\n  return (\\n    <div>\\n      <button type=\\\"button\\\" onClick={() => updateLastUsedColors('red')}>\\n        Use red\\n      </button>\\n      <button type=\\\"button\\\" onClick={() => updateLastUsedColors('blue')}>\\n        Use blue\\n      </button>\\n      <button type=\\\"button\\\" onClick={() => updateLastUsedColors('purple')}>\\n        Use purple\\n      </button>\\n      <button type=\\\"button\\\" onClick={() => updateLastUsedColors('yellow')}>\\n        Use yellow\\n      </button>\\n      {lastUsedColors && (\\n        <Fragment>\\n          <h5>Last used colors:</h5>\\n          <ul>\\n            {lastUsedColors?.map((color) => <li key={color}>{color}</li>)}\\n          </ul>\\n        </Fragment>\\n      )}\\n    </div>\\n  )\\n}\\n\"\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}}},"__N_SSG":true}